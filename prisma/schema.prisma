generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                   String     @id @default(uuid())
  name                 String
  createdAt            DateTime   @default(now())
  image                String?
  currentCountryId     String?
  currentPrefectureId  String?
  deploymentCountryId  String?
  cohortId             String?
  twitterUrl           String?
  instagramUrl         String?
  websiteUrl           String?
  bio                  String?
  currentCountry       Country?   @relation("CurrentCountry", fields: [currentCountryId], references: [id])
  currentPrefecture    Prefecture? @relation(fields: [currentPrefectureId], references: [id])
  deploymentCountry    Country?   @relation("DeploymentCountry", fields: [deploymentCountryId], references: [id])
  cohort               Cohort?    @relation(fields: [cohortId], references: [id])
  favoritedBy          Favorite[] @relation("FavoritedUsers")
  favorites            Favorite[] @relation("UserFavorites")
}

model Country {
  id                  String     @id @default(uuid())
  name                String     @unique
  slug                String     @unique
  isDeveloping        Boolean    @default(false)
  continent           String?
  currentUsers        User[]     @relation("CurrentCountry")
  deployedUsers       User[]     @relation("DeploymentCountry")
  prefectures         Prefecture[]
}

model Prefecture {
  id        String   @id @default(uuid())
  name      String
  slug      String   @unique
  countryId String
  country   Country  @relation(fields: [countryId], references: [id])
  users     User[]
}

model Cohort {
  id         String @id @default(uuid())
  name       String
  cohortYear String
  cohortTerm String
  users      User[]
}

model Favorite {
  id             String @id @default(uuid())
  userId         String
  favoriteUserId String
  favoriteUser   User   @relation("FavoritedUsers", fields: [favoriteUserId], references: [id])
  user           User   @relation("UserFavorites", fields: [userId], references: [id])

  @@unique([userId, favoriteUserId])
}